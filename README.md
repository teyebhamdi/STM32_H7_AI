
# **Running an AI Model on STM32 with X-CUBE-AI**  

This project demonstrates how to execute a text classification AI model on an STM32 microcontroller using the X-CUBE-AI tool from STMicroelectronics.  

## **Objectives**  
1. Develop a text classification AI model on a PC (Python/TensorFlow).  
2. Optimize and convert the model for STM32 using X-CUBE-AI.  
3. Deploy the model on an STM32 board and perform text classifications.  
4. Compare performance (accuracy, execution time, resource usage) between STM32 and a PC.  

---

## **Requirements**  
### **Hardware Requirements**  
- STM32H7 board.  
- USB cable for programming and power.  

### **Software Requirements**  
- [STM32CubeMX](https://www.st.com/en/development-tools/stm32cubemx.html).  
- [X-CUBE-AI](https://www.st.com/en/embedded-software/x-cube-ai.html).  
- [Python](https://www.python.org/) (with TensorFlow).  
- STM32CubeIDE (for C/C++ development).  

---

## **Installation**  

1. **Clone this repository:**  
   ```bash
   git clone https://github.com/teyebhamdi/STM32_H7_AI.git
   cd <STM32_H7_AI>
   ```

2. **Configure the project with STM32CubeMX:**  
   - Open the `.ioc` file provided in the repository.  
   - Verify peripheral settings and the integration of X-CUBE-AI.  

3. **Build the project:**  
   - Import the project into STM32CubeIDE.  
   - Compile and flash the firmware onto the STM32 board.  

4. **Prepare the AI model:**  
   - Run the Python script to train and export the AI model:  
     ```bash
    text_classification_dense_input.h5
     ```
   - Load the converted model into the STM32 project using X-CUBE-AI.  

5. **Run and test:**  
   - Connect the STM32 board to the PC via USB.  
   - Monitor the logs (USB) to observe classification results.  

---

## **Project Structure**  
```
STM32_H7_AI/
│
├── Core/                   # STM32 core files (Cortex-M)
├── Drivers/                # STM32 hardware drivers
├── Middlewares/            # Files generated by X-CUBE-AI
├── AI_Model/               # AI model and associated Python scripts
├── STM32CubeMX_Project/    # STM32CubeMX project files (.ioc)
├── text_classification_dense_input.h5        # Script for training the AI model
├── README.md               # This file
└── LICENSE                 # Project license
```

---

## **Execution Examples**  

1. **Results on STM32:**  
   Example: The movie was okay.
   Example: The movie was terrible...
   Prediction: 0.469787
   Prediction: 0.481103
2. **Comparison with PC:**  
   - Similar accuracy achieved.  

---

## **Contributions**  
Contributions are welcome! Please submit your suggestions via pull requests or open issues.  

---

